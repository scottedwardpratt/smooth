\documentclass[12pt]{article}
%#Scott Pratt, Eren Erdogan, Ekaksh Kataria 2023
\usepackage{subfiles}
%\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage[
        pdfencoding=auto,%
        pdftitle={Smooth Emulator and Training Point Optimizer}
        pdfauthor={Scott Pratt},%
        pdfstartview=FitV,%
        colorlinks=true,%
        linkcolor=blue,%
        citecolor=blue, %
        urlcolor=blue,
				breaklinks=true]{hyperref}
%\usepackage[anythingbreaks,hyphenbreaks]{breakurl}
\usepackage{xurl,hyperref}
\usepackage{comment}
%\usepackage{pdfsync}
\usepackage{amssymb}
\usepackage{amsmath}
%\usepackage{nopageno}
\usepackage{bm}
\usepackage{dsfont}
%\usepackage[utf8]{inputenc}
\usepackage[small,bf]{caption}
%\usepackage{fontspec}
%\usepackage{textcomp}
%\usepackage{color}
%\usepackage{fancyhdr}
\usepackage[titletoc]{appendix}
%\usepackage[headheight=110pt]{geometry}
\usepackage{bm}

\def\theenumi{\Roman{enumi}}

\numberwithin{equation}{section} 
\numberwithin{figure}{section} 

%\usepackage[most]{tcolorbox}
%\tcbset{
%frame code={}
%center title,
%left=0pt,
%right=0pt,
%top=0pt,
%bottom=0pt,
%colback=gray!25,
%colframe=white,w
%width=\dimexpr\textwidth\relax,
%enlarge left by=0mm,
%boxsep=5pt,
%arc=0pt,outer arc=0pt,
%}
%\newcounter{examplecounter}
%\counterwithin{examplecounter}{section}
%\setcounter{examplecounter}{0}
%\newcommand{\example}[2]{\begin{tcolorbox}[breakable,enhanced]
%\refstepcounter{examplecounter}{
%\bf Example \arabic{section}.\arabic{examplecounter}:}~~{\bf #1}\\
%{#2}
%\end{tcolorbox}
%}

%\newcommand{\exampleend}{
%\begin{samepage}
%\nopagebreak\noindent\rule{\textwidth}{1pt}
%\end{samepage}
%}

%\usepackage{silence}
%\WarningFilter{hyperref}{Token not allowed in a PDF String}

\newcommand\eqnumber{\addtocounter{equation}{1}\tag{\theequation}}
%\newcommand{\solution}[1]{ }
\newcommand\identity{\mathds{1}}

\setlength{\headheight}{16pt}
\parskip 6pt
\parindent 0pt
\textwidth 7.0in
\hoffset -0.8in
\textheight 9.2in
\voffset -1in

%\newcommand{\bm}{\boldmath}
\boldmath
%
\begin{document}


\begin{titlepage}
   \begin{center}
       \vspace*{1.5cm}

       {\bf\LARGE {\it Smooth Emulator \&  Training Point Optimizer}}\\
       \vspace*{8pt}

       {\bf\Large User Manual}

       {\bf A BAND Collaboration Project}\\
       \href{https://bandframework.github.io}{https://bandframework.github.io}
       
       \begin{center}
     
       \includegraphics[width=0.24\textwidth]{figs/BAND_logo.png}
      \end{center}
      


       \vspace{0.25cm}

       {\large Scott Pratt, Oleh Savchuk, Eren Erdogan, Ekaksh Kataria}

       {\it Department of Physics and Facility for Rare Isotope Beams}

       {\it Michigan State University, East Lansing Michigan, 48824}

       \today
  \end{center}
       
    \vspace*{3.0cm}
     

     \hspace*{2.0cm}
      \includegraphics[width=0.16\textwidth]{figs/FRIB_logo.png}

       \vspace*{-3cm}
       \hspace*{6.35cm}
       \includegraphics[width=0.26\textwidth]{figs/msu_logo}

       
       
       \vspace*{-1.75cm}
       \hspace*{12.5cm}
       \includegraphics[width=0.12\textwidth]{figs/nsf_logo.png}

       
%\vspace*{0.5cm}

\begin{center}
{\it This project was supported by the National Science Foundation\\ through the Office of Cyberinfrastructure for Sustained Scientific Motivation (CSSI)}
\end{center}

\end{titlepage}

\newpage

\thispagestyle{empty}

\tableofcontents

\newpage

\thispagestyle{empty}

\section{Overview}\label{sec:overview}

{\it Smooth Emulator} software is designed with the idea that the full-model to be emulated is {\it smooth}. I.e., if one were represent the behavior as a Taylor expansion, one would expect higher-order terms to contribute less than lower-order terms. The programs that choose the training points are based on such an assumption, and the emulator's mathematical form also presumes such behavior. Applying the software to emulation of a full-model that has sharp peaks or valleys is probably dubious. The programs tend to run quickly as long as the number of model-parameters is of the order a dozen or less.

The software performs three basic functions.
\begin{enumerate}\itemsep=0pt
\item Provide an optimum set of training points in model parameter space, at which full model runs will performed to then tune the emulator. The User must also provide a list of observables which are then to be emulated and a measure of the relative importance of each model parameter.
\item After the User runs their full model at each of the training points and provides values and uncertainties for the observables at each training point, emulators are created for each observable. The emulator form is based on two hyper-parameters, an amplitude and a convergence length. The emulator is equivalent to a Gaussian process emulator with a quadratic kernel.
\item If the User provides a list of experimentally measured observables and uncertainties, an MCMC program samples the prior and provides a sampling of points in the model-parameter space that are consistent with the measurement. An analysis program uses the list of representative points to calculate the mean and covariances of the posterior distribution. The program also provides the resolving power of specific observables in regards to constraining specific model parameters.
\end{enumerate}

The structure is designed so that the User stores all the information for a specific analysis in a specific analysis directory, e.g. {\tt  \$\{MY\_ANALYSIS\}/}. All programs are then run from that directory.  A subdirectory, {\tt  \$\{MY\_ANALYSIS\}/smooth\_data/Info}, contains simple text files edited by the User to describe the model-parameter priors, the observables to be emulated and evaluated, and the experimentally observed values. A second subdirectory, {\tt \$\{MY\_ANALYSIS\}/smooth\_data/Options} contains text files defining options the User can set related to the {\it Smooth Emulator} software. The training point optimization software creates directories {\tt  \$\{MY\_ANALYSIS\}/smooth\_data/FullModelRuns/runI} where each training point, {\tt $\hdots$/runI}, refers to a single point in model-parameter space used for training. The training point optimizer program creates a test file listing the values of the model parameters. The User's job is then to create text files giving the values of the observables calculated by the full model for that point in model-parameter space. Once the User has performed this, one can run programs that build and tune emulators for each emulator, and if desired, run the MCMC program. The MCMC writes the MCMC trace information in {\tt  \$\{MY\_ANALYSIS\}/smooth\_data/mcmc\_trace/}. {\it Smooth Emulator} provides programs are provided that analyze the trace to provide covariances of the the posterior and measures of the resolving power. A {\tt  \$\{MY\_ANALYSIS\}/figs} directory includes several python scripts to plot results of these analyses based on Matplotlib. 

{\it Smooth Emulator} software is designed to be modular. Programs for each of the three functionalities listed above can be performed independently because files are all in simple text formats. For example, one can generate the training points, then use those training points emulators from other software packages. However, the User will likely have to spend more time translating text files to formats used by other programs. 

\newpage

\subfile{installation.tex}

\newpage

\subfile{tpo.tex}

\newpage

\subfile{fullmodel.tex}

\newpage

\subfile{emulator.tex}

\newpage

\subfile{mcmc.tex}

\newpage

\subfile{tutorial.tex}

%\newpage

%\subfile{theory_short.tex}

\end{document}

